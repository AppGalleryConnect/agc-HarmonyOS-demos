import { ErrorInfo } from '@aliyun_video_cloud/aliyun_player';

@Component
export struct ErrorInfoWin {
  @Prop isShow: boolean
  @Prop errInfo: ErrorInfo
  onRefreshClick: Function = () => {}
  build() {
    if (this.isShow) {
      Column() {
        Row() {
          Column() {
            Row() {
              SymbolGlyph($r('sys.symbol.exclamationmark_circle'))
                .fontSize(33)
                .fontColor(['rgba(255, 255, 255, 0.6)'])
            }
            Row() {
              Text(errorMessage.get(this.errInfo.getCode()) ?? '播放出现异常，请刷新重试')
                .fontSize(14)
                .fontColor('rgba(255, 255, 255, 0.6)')
            }
            .margin({
              top: 13.5, bottom: 6
            })
            Row() {
              Text('点击刷新')
                .fontSize(14)
                .fontColor('#FF7500')
                .onClick(() => {
                  this.onRefreshClick()
                })
            }
          }
          .alignItems(HorizontalAlign.Center)
          .backgroundColor('rgba(0, 0, 0, 0.7)')
          .padding(20)
          .borderRadius(5)
        }
        .height('100%')
        .alignItems(VerticalAlign.Center)
      }
      .width("100%")
      .height("100%")
    }
  }
}

const errorMessage = new Map([

  // 请求错误码
  [536936449, '服务器返回数据为空'],
  [536936450, '服务器返回数据不为JSON格式'],
  [536936451, '没有找到匹配的清晰度'],
  [536936452, 'PlayAuth解析错误'],
  [536936453, '请求失败'],
  [536936454, '服务端返回播放信息为空'],

  // 点播错误码
  [536936960, 'VOD未知错误'],

  [536936961, '视频状态无效'],
  [536936962, '视频不存在'],
  [536936963, '根据您的筛选条件找不到可以播放的转码输出流'],
  [536936964, '当前仅存在阿里云视频加密的转码输出流'],
  [536936965, 'AuthInfo与vid不一致'],
  [536936966, 'AuthInfo过期'],

  [537001983, '未知错误'],
  [537067520, 'Demuxer错误起始码'],
  [537067521, '打开URL失败'],
  [537067522, '无效的流'],
  [537067523, '打开流失败'],
  [537067524, '加载超时'],
  [537067525, '数据源URL为空'],
  [537067527, '网络DNS解析失败'],
  [537067528, '无法连接到服务器'],
  [537067529, '网络接收脏数据'],
  [537067530, '没有网络访问'],
  [537067531, '网络传输速率过低'],
  [537067532, 'SSL连接超时'],
  [537067533, 'DNS解析超时'],
  [537067534, 'DNS解析超时'],
  [537067533, 'TCP连接超时'],
  [537133057, '视频解码失败'],
  [537133058, '音频解码失败'],
  [537198591, '重定向到了一个不是媒体文件的URL'],
  [537198592, '未知的网络错误'],
  [537198593, '协议不支持'],
  [537198594, '不能解析域名'],
  [537198595, '网络连接超时'],
  [537198596, '无法连接到服务器'],
  [537198597, '403错误'],
  [537198598, '404错误'],
  [537198599, '其他的4XX错误'],
  [537198600, '5XX的服务器错误'],
  [537198601, '不支持range请求'],
  [537198602, '400错误'],

  [537264128, '未知的解码错误'],
  [537264129, '视频编码格式不支持'],
  [537264130, '音频编码格式不支持'],
  [537329664, '内部未知错误'],
  [537329665, '内部退出'],
  [537395200, '标准错误'],
  [537395201, '标准错误-1，操作不允许等'],
  [537395202, '标准错误-2，文件不存在等'],
  [537395205, '标准错误-5，IO错误等'],
  [537395206, '数据读取权限校验失败'],
  [537395208, '解复用权限校验失败'],
  [537460736, '未知渲染错误'],
  [537460737, '打开音频设备失败'],
  [537526272, '未知格式错误'],
  [537526273, '该媒体格式不支持'],
  [537526274, 'MP4媒体URL必须添加etavirp_nuyila=1才能播放私有加密'],
  [537526275, 'MP4媒体meta中未找到key info 或 key info无效'],
  [537526276, 'HLS媒体meta中未找到key info 或 key info无效'],
  [805306367, '网络连接重试超时，请切换网络重试'],

  [1073807360, 'MediaLoader未知错误'],
  [1073807361, '同一个URL已经加载过'],
  [1073807362, '本地缓存未开启，预加载失败'],
  [1073807363, '不支持'],
  [1073807364, '没有找到Track'],
  [-300, '同一个URL已经加载过'],
  [-301, '本地缓存未打开，预加载失败'],
])
